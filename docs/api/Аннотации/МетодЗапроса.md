# МетодЗапроса

Аннотация, помечающая метод хранилища сущностей, для которого необходимо сгенерировать тело метода с выполнением запроса к базе данных на основании имени метода.

## Синтаксис

```1c
&МетодЗапроса
Функция ИмяМетода(Параметры...) Экспорт
    Возврат Неопределено;
КонецФункции
```

## Описание

Аннотация `&МетодЗапроса` позволяет автоматически генерировать реализацию методов запросов на основе их имен. Библиотека анализирует имя метода и создает соответствующий код для выполнения запроса к базе данных.

## Правила именования методов

Имя метода должно следовать определенной структуре:

```
[Режим][Ограничения][Условия][Сортировка]
```

Где:
- **Режим** - `Получить` или `ПолучитьОдно`
- **Ограничения** - `Первые`, `СоСмещением` (опционально)
- **Условия** - `По[Поле][ВидСравнения]` (опционально)
- **Сортировка** - `УпорядочитьПо[Поле][Направление]` (опционально)

## Поддерживаемые токены

### Режимы поиска
- `ПолучитьОдно` - возвращает один объект
- `Получить` - возвращает коллекцию объектов

### Ограничения
- `Первые` - ограничивает количество записей
- `СоСмещением` - пропускает записи с начала

### Виды сравнения
- `Равно` (по умолчанию)
- `НеРавно`
- `Больше`
- `БольшеИлиРавно`
- `Меньше`
- `МеньшеИлиРавно`
- `В` - значение в списке
- `НеВ` - значение не в списке

### Направления сортировки
- `Возр` (по умолчанию)
- `Убыв`

### Логические операторы
- `И` - логическое И между условиями

## Примеры

### Простые запросы

```1c
// Получить все записи
&МетодЗапроса
Функция ПолучитьВсе() Экспорт
    Возврат Неопределено;
КонецФункции

// Найти по ID
&МетодЗапроса
Функция ПолучитьОдноПоИдентификаторРавно(Идентификатор) Экспорт
    Возврат Неопределено;
КонецФункции
```

### Сложные условия

```1c
// Множественные условия
&МетодЗапроса
Функция ПолучитьПоИмениРавноИВозрастБольше(Имя, Возраст) Экспорт
    Возврат Неопределено;
КонецФункции

// С сортировкой
&МетодЗапроса
Функция ПолучитьПоАктивенРавноУпорядочитьПоДатаСозданияУбыв(Активен) Экспорт
    Возврат Неопределено;
КонецФункции
```

### С ограничениями

```1c
// Пагинация
&МетодЗапроса
Функция ПолучитьПервыеСоСмещениемПоВозрастБольшеИлиРавноУпорядочитьПоИмениВозр(
    Количество, 
    Смещение, 
    Возраст
) Экспорт
    Возврат Неопределено;
КонецФункции
```

## Генерируемый код

Для метода:
```1c
&МетодЗапроса
Функция ПолучитьПоИмениРавноИВозрастБольше(Имя, Возраст) Экспорт
    Возврат Неопределено;
КонецФункции
```

Будет сгенерирован код:
```1c
Функция ПолучитьПоИмениРавноИВозрастБольше(Имя, Возраст) Экспорт
    ОпцииПоиска = Новый ОпцииПоиска();
    ОпцииПоиска.Отбор("Имя", ВидСравнения.Равно, Имя);
    ОпцииПоиска.Отбор("Возраст", ВидСравнения.Больше, Возраст);
    Возврат ХранилищеСущностей.Получить(ОпцииПоиска);
КонецФункции
```

## Требования

- Метод должен быть помечен аннотацией `&МетодЗапроса`
- Метод должен возвращать `Неопределено` в исходной реализации
- Параметры метода должны соответствовать порядку их использования в имени метода
- Класс должен быть помечен аннотацией `&ХранилищеСущностей`
- Имена полей в методе должны соответствовать свойствам сущности

## Ограничения

- Не все комбинации токенов поддерживаются
- Сложные запросы лучше реализовывать вручную с использованием `ОпцииПоиска`
- Регистр имен полей должен точно совпадать с определением в сущности

## См. также

- [ХранилищеСущностей](ХранилищеСущностей.md)
- [Методы запросов](/docs/product/030-query-methods.md)